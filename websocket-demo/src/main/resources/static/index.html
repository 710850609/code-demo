<!DOCTYPE html>
<html lang="zh">
    <meta charset="UTF-8">
    <script type="application/javascript">
        function checkPermission() {
            if (!('Notification' in window)) {
                console.warn("当前浏览器不支持通知功能，请使用Chrome内核等浏览器");
            } else if (Notification.permission !== 'granted') {
                Notification.requestPermission(function (permission) {
                    if (permission !== 'granted') {
                        console.log('用户禁止了浏览器通知功能')
                    }
                });
            }
        }

        function playSound (src) {
            var sound = document.getElementById("sound-play");
            console.log(sound)
            sound.src = src
        }

        function notify() {
            var option = {
                body: '图标路径可以是以http或https开头的网络图片，如：,图标大小不超过 30 k; 也可以是位于drawable资源文件夹的图标路径，如：；如果有此字段值，推送一定走极光自有通道下发。',
                tag: '',
                icon: 'https://img10.360buyimg.com/n1/s450x450_jfs/t1/105578/40/5462/272206/5dedadffE08962f1d/f7e42d5007e9c9e4.jpg',
                data: {
                    sound: 'https://www.w3school.com.cn/i/song.ogg',
                    name: '通知参数'
                }
            }
            var notify = new Notification('热销产品', option)
            notify.onclick = function(e) {
                console.log('点击通知')
                console.log(e.target)
            }
            notify.onshow = function (e) {
                console.log('显示通知')
                console.log(e.target)
                var sound = e.target.data.sound
                playSound(sound)
            }
        }

        checkPermission()
    </script>
    <body>
        <button onclick="notify()">通知</button>
        <audio src="/static/neworder.wav"></audio>
        <audio id="sound-play" autoplay="true"></audio>
    </body>
</html>